# Анализ выживаемости насосов УЭЦН  
В данный проект включены различные подходы, подробности о которых вы можете найти в Notebooks

## Описание проекта

В данном проекте описано несколько подходов, а также выбран итоговый подход с точки зрения поиска аномалий во временных рядах с помощью LSTM- Автоэнкодера, для предсказания поломок насосов УЭЦН.
Насосы УЭЦН- установки электроцетробежных насосов, которые используются при добыче нефти. 
Суммарно в РФ их насчитывается более 150 тыс.
На промысле недропользователь ориентируется на плановую наработку на отказ, что не решает проблему и в большинстве случаев приводит к простоям.
Использование данной модели позволит минимизировать простои и заранее спланировать операции по замене УЭЦН, поскольку данная модель прогнозирует выбытие в диапозоне до 30 дней

## Метрики финальной модели 

| Метрика          | Значение |
|------------------|----------|
| Accuracy         | 0.999    |
| Precision        | 0.997    |
| Recall           | 0.998    |
| F1-Score         | 0.999    |
| ROC AUC          | 0.999    |
| normal detected  | 0.999    |
| anomaly detected | 0.999    |


## Структура проекта

- **app.py** - файл с приложением
- **notebooks** - ноутбуки, которые могут пригодиться для тех, кто занимается чем-то похожим и не знает куда двигаться
- **Notebooks Autoenc with FFT features** - ноутбуки с финальными моделями с предобработкой данных и 2 вариантами обучения модели: только на фичах FFT (imag+real), а также FFT+ оригинальные фичи временных рядов
- **lstmae_fft_only.pth** - финальная предобученная модель LSTM Автоэнкодера на датасете в 2 млн. строк по параметрам FFT
- **catboost_model_сuz.cbm** - модель Catboost classifier, которая определяет возможные осложнения при работе насоса
- **test.csv** - тестовый файл с синтетическими данными, чтобы сторонний пользователь смог самостоятельно увидеть результат

## Приложение


- Доступно на платформе streamlit по ссылке:
**https://pumpssurvivalanalysis-hmbsb7sghrvkzje7bc4kvq.streamlit.app**


**Структура приложения**

- **Главная**- стартовая страница, с панелью навигации, а также возможностью загрузить файл. Если файла нет, то загружается тестовый и отображается в табличном виде.
- **Интеллектуальный анализ выживаемости**- анализирует данные в файле с использованием модели Автоэкнодера  для детектирования аномалий, а также с помощью Catboost выдает топ 3 возможных осложнений, которые можно узнать только после поломки скважины.
- **Обучить модель** позволяет дообучить модель на основе имеющихся данных при начилии разметки по Наработке на отказ. Данные предобрабатываются в соответствии с промысловыми требованиями: удаление выбросов, заполнение пропусков; игнорируются данные 30 дней до выбытия. Дообученную модель можно сохранить и использовать в анализе выживаемости. 

Стандартная модель загружается по дефолту, дообученная через специальное окно, куда можно загрузить файл модели

Ранние аномалии- приработка насоса

- Изменения: добавлен ноутбук в Notebooks Autoenc with FFT, где разделение датасета по размеру распределилось следующим образом: 
- train=0.5, val=0.25, test=0.25
